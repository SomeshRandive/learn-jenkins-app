pipeline {
    agent any

    environment {
        REMOTE_USER = 'ip172-18-0-55-cudenci91nsg008rquk0'
        REMOTE_HOST = 'direct.labs.play-with-docker.com'
        SSH_CREDENTIALS = 'pwd-ssh'  // This is the ID from Jenkins credentials
    }

    stages {
        stage('Build') {

            steps {

                sshCommand remote: [host: REMOTE_HOST, user: REMOTE_USER, credentialsId: SSH_CREDENTIALS], command: '''
                    echo "Connected to $(hostname)"
                    uname -a
                '''

                sh '''
                ls -la
                node --version
                npm --version
                sh 'docker version'
                npm ci
                npm run build
                '''
            }
        }
    }
}
